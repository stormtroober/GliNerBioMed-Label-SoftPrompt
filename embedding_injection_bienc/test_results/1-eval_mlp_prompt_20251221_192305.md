# Risultati Test - MLP Prompt Encoder

**Checkpoint:** `mlp_focal_cbclass_val-20251221_192013.pt`

**Dataset:** `../dataset/test_dataset_tokenlevel.json`

**Data:** 2025-12-21 19:23:05

---

## üéØ CONFIGURAZIONE PROMPT TUNING

| Parametro | Valore |
|:----------|:-------|
| **üîß Prompt Length** | **32** |
| **üîß Pooling Mode** | **conv1d** |
| **üìù Descrizione** | Conv1D + AdaptiveAvgPool |
| **Projection Trained** | ‚úÖ S√¨ |

---

## ‚öôÔ∏è Parametri di Training Salvati

| Parametro | Valore |
|:----------|:-------|
| **prompt_len** | **32** |
| **pooling_mode** | **conv1d** |
| batch_size | 128 |
| epochs | 25 |
| dataset_size | 16600 |
| lr_mlp | 0.002 |
| lr_proj | 0.002 |
| temperature | 0.011641058260782156 |
| gamma_focal_loss | 5.0 |
| cb_beta | 0.9999 |
| dropout_rate | 0.1 |
| early_stopping_patience | 5 |
| grad_clip | 1.0 |
| random_seed | 42 |
| train_size | 14940 |
| val_size | 1660 |
| validation_ratio | 0.1 |
| validation_split | True |
| warmup_ratio | 0.10603059187238079 |
| warmup_steps | 310 |
| weight_decay | 0.01 |
| weight_strategy | ClassBalanced |

## üìà Metriche Globali

| Metric | Score |
|:-------|------:|
| **Macro F1** | **0.7371** |
| **Micro F1** | **0.8949** |
| Token Totali | 65,191 |

## üìä Metriche per Classe (Dettagliate)

| Classe | Precision | Recall | F1-Score | Support | Predicted |
|:-------|----------:|-------:|---------:|--------:|----------:|
| **cell type** | 0.8112 | 0.6699 | 0.7338 | 3747 | 3094 |
| **rna** | 0.6803 | 0.7331 | 0.7057 | 296 | 319 |
| **cell line** | 0.4377 | 0.7198 | 0.5444 | 1235 | 2031 |
| **dna** | 0.7147 | 0.6787 | 0.6962 | 2278 | 2163 |
| **protein** | 0.7603 | 0.8316 | 0.7943 | 8885 | 9719 |
| **O** | 0.9566 | 0.9392 | 0.9478 | 48750 | 47865 |
| **TOTAL** | - | - | - | 65191 | 65191 |

## üìã Classification Report Completo

```
              precision    recall  f1-score   support

   cell type     0.8112    0.6699    0.7338      3747
         rna     0.6803    0.7331    0.7057       296
   cell line     0.4377    0.7198    0.5444      1235
         dna     0.7147    0.6787    0.6962      2278
     protein     0.7603    0.8316    0.7943      8885
           O     0.9566    0.9392    0.9478     48750

    accuracy                         0.8949     65191
   macro avg     0.7268    0.7621    0.7371     65191
weighted avg     0.9020    0.8949    0.8971     65191

```

## üî¢ Distribuzione Predizioni vs Ground Truth

| Classe | Predette | Vere | Differenza | % Coverage |
|:-------|:--------:|:----:|:----------:|:----------:|
| O | 47865 | 48750 | -885 | 98.2% |
| protein | 9719 | 8885 | +834 | 109.4% |
| cell type | 3094 | 3747 | -653 | 82.6% |
| dna | 2163 | 2278 | -115 | 95.0% |
| cell line | 2031 | 1235 | +796 | 164.5% |
| rna | 319 | 296 | +23 | 107.8% |

## üîÄ Top Confusioni (Errori pi√π frequenti)

| Vera Classe | Predetta Come | Count |
|:------------|:--------------|------:|
| O | protein | 1733 |
| protein | O | 1129 |
| cell type | cell line | 625 |
| cell type | O | 532 |
| O | cell line | 466 |
| dna | protein | 437 |
| O | cell type | 359 |
| O | dna | 349 |
| dna | O | 272 |
| protein | dna | 249 |
| cell line | cell type | 182 |
| cell line | O | 133 |
| cell type | protein | 80 |
| O | rna | 55 |
| rna | protein | 50 |
| protein | cell line | 46 |
| protein | cell type | 42 |
| cell line | protein | 30 |
| protein | rna | 30 |
| rna | dna | 18 |
